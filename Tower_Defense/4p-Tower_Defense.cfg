[multiplayer]
 id="Velensk'sTowerDefense"
 name= _ "Wesnoth_Tower_Defense"
 description= _ "Hold out against large numbers of enemies on a large and varied map
Created by Velensk
"
 map_data="{~add-ons/Tower_Defense/4p-Wesnoth_Tower_Defense.map}"
 turns=-1

 {DEFAULT_SCHEDULE}
 {SCENARIO_MUSIC knalgan_theme.ogg}
 {EXTRA_SCENARIO_MUSIC knolls.ogg}
 {EXTRA_SCENARIO_MUSIC loyalists_theme.ogg}
 {EXTRA_SCENARIO_MUSIC siege_of_laurelmor.ogg}
 {EXTRA_SCENARIO_MUSIC the_dangerous_symphony.ogg}
 {EXTRA_SCENARIO_MUSIC the_deep_path.ogg}
 {EXTRA_SCENARIO_MUSIC the_city_falls.ogg}


 experience_modifier=100%
 victory_when_enemies_defeated=no

[side]
	side=1
	controller=human
	team_name=Defender
	gold=250
	income=10
	fog=no
	village_gold=2
	colour_lock=true
	colour=red
        team_lock=yes
	income_lock=yes

        type=Spearman
        id=1stleader
	canrecruit=yes
[/side]

[side]
	side=2
	controller=human
	team_name=Defender
	gold=250
	income=10
	fog=no
	village_gold=2
	colour_lock=true
	colour=blue
        team_lock=yes
	income_lock=yes

        type=Spearman
        id=2stleader
	canrecruit=yes
[/side]

[side]
	side=3
	controller=human
	team_name=Defender
	gold=250
	income=10
	fog=no
	village_gold=2
	colour_lock=true
	colour=green
        team_lock=yes
	income_lock=yes

        type=Spearman
        id=3stleader
	canrecruit=yes
[/side]

[side]
	side=4
	controller=human
	team_name=Defender
	gold=250
	income=10
	fog=no
	village_gold=2
	colour_lock=true
	colour=purple
        team_lock=yes
	income_lock=yes

        type=Spearman
        id=4stleader
	canrecruit=yes
[/side]

[side]
	side=5
	controller=ai
	team_name=Attacker
	canrecruit=no
	gold=0
	income=-2
	fog=no
	village_gold=2
        no_leader=yes
	allow_player=false
	colour_lock=true
	colour=orange
	[ai]
	   [protect_location]
                x,y=23,24
                radius=1
                value=1000
	   [/protect_location]
	    caution=0
            grouping=no
	    aggression=-4
	    attack_depth=1
	    simple_targeting=yes
	[/ai]
[/side]

[side]
	side=6
	controller=ai
	team_name=Defender
	canrecruit=no
	gold=0
	income=-2
	fog=no
	village_gold=0
        no_leader=yes
	allow_player=false
	colour_lock=true
	colour=red
        [unit]
            x,y=23,24
            type=TheTower
        [/unit]
[/side]

[side]
	side=7
	controller=ai
	team_name=Defender
	canrecruit=no
	gold=0
	income=-2
	fog=no
	village_gold=0
        no_leader=yes
	allow_player=false
	colour_lock=true
	colour=blue
[/side]

[side]
	side=8
	controller=ai
	team_name=Defender
	canrecruit=no
	gold=0
	income=-2
	fog=no
	village_gold=0
        no_leader=yes
	allow_player=false
	colour_lock=true
	colour=green
[/side]

[side]
	side=9
	controller=ai
	team_name=Defender
	canrecruit=no
	gold=0
	income=-2
	fog=no
	village_gold=0
        no_leader=yes
	allow_player=false
	colour_lock=true
	colour=purple
[/side]

#define TARGET TYPE X Y
    # Place a named unit with embedded WML specified.
    #
    [unit]
        side=5
        type={TYPE}
        x={X}
        y={Y}
        id=target
    [/unit]
#enddef

[event]
 name=prestart
[if]
	[have_unit]
	     type=Spearman
             count=1
	[/have_unit]
        [then]
            [set_variable]
                 name=players
                 value=1
            [/set_variable]
            [store_unit]
                 [filter]
                    x,y=23,24
                 [/filter]
                 variable=tower
		 kill=yes
            [/store_unit]
            [set_variable]
                 name=tower.hitpoints
                 value=20
            [/set_variable]
            [set_variable]
                 name=tower.max_hitpoints
                 value=20
            [/set_variable]
            [unstore_unit]
                variable=tower
            [/unstore_unit]
        [/then]

[/if]
[if]
	[have_unit]
	     type=Spearman
             count=2
	[/have_unit]
        [then]
            [set_variable]
                 name=players
                 value=2
            [/set_variable]
                    [store_unit]
                           [filter]
                           x,y=23,24
                           [/filter]
                           variable=tower
			   kill=yes
                       [/store_unit]
            [set_variable]
                 name=tower.hitpoints
                 value=30
            [/set_variable]
            [set_variable]
                 name=tower.max_hitpoints
                 value=30
            [/set_variable]
                    [unstore_unit]
                           variable=tower
                    [/unstore_unit]
        [/then]
[/if]
[if]
	[have_unit]
	     type=Spearman
             count=3
	[/have_unit]
        [then]
            [set_variable]
                 name=players
                 value=3
            [/set_variable]
                    [store_unit]
                           [filter]
                           x,y=23,24
                           [/filter]
                           variable=tower
			   kill=yes
                       [/store_unit]
            [set_variable]
                 name=tower.hitpoints
                 value=40
            [/set_variable]
            [set_variable]
                 name=tower.max_hitpoints
                 value=40
            [/set_variable]
                    [unstore_unit]
                           variable=tower
                    [/unstore_unit]
        [/then]
[/if]
[if]
	[have_unit]
	     type=Spearman
             count=4
	[/have_unit]
        [then]
            [set_variable]
                 name=players
                 value=4
            [/set_variable]
                    [store_unit]
                           [filter]
                           x,y=23,24
                           [/filter]
                           variable=tower
			   kill=yes
                       [/store_unit]
            [set_variable]
                 name=tower.hitpoints
                 value=50
            [/set_variable]
            [set_variable]
                 name=tower.max_hitpoints
                 value=50
            [/set_variable]
                    [unstore_unit]
                           variable=tower
                    [/unstore_unit]
        [/then]
[/if]

            [set_variable]
                 name=damage
                 value=0
            [/set_variable]
            [set_variable]
                 name=p1basic
                 value=0
            [/set_variable]
            [set_variable]
                 name=p2basic
                 value=0
            [/set_variable]
            [set_variable]
                 name=p3basic
                 value=0
            [/set_variable]
            [set_variable]
                 name=p4basic
                 value=0
            [/set_variable]

            [set_variable]
                 name=p1ice
                 value=0
            [/set_variable]
            [set_variable]
                 name=p2ice
                 value=0
            [/set_variable]
            [set_variable]
                 name=p3ice
                 value=0
            [/set_variable]
            [set_variable]
                 name=p4ice
                 value=0
            [/set_variable]

            [set_variable]
                 name=p1fire
                 value=0
            [/set_variable]
            [set_variable]
                 name=p2fire
                 value=0
            [/set_variable]
            [set_variable]
                 name=p3fire
                 value=0
            [/set_variable]
            [set_variable]
                 name=p4fire
                 value=0
            [/set_variable]

            [set_variable]
                 name=p1stealth
                 value=0
            [/set_variable]
            [set_variable]
                 name=p2stealth
                 value=0
            [/set_variable]
            [set_variable]
                 name=p3stealth
                 value=0
            [/set_variable]
            [set_variable]
                 name=p4stealth
                 value=0
            [/set_variable]

            [set_variable]
                 name=p1champion
                 value=0
            [/set_variable]
            [set_variable]
                 name=p2champion
                 value=0
            [/set_variable]
            [set_variable]
                 name=p3champion
                 value=0
            [/set_variable]
            [set_variable]
                 name=p4champion
                 value=0
            [/set_variable]

            [set_variable]
                 name=p1blaster
                 value=0
            [/set_variable]
            [set_variable]
                 name=p2blaster
                 value=0
            [/set_variable]
            [set_variable]
                 name=p3blaster
                 value=0
            [/set_variable]
            [set_variable]
                 name=p4blaster
                 value=0
            [/set_variable]

	{SET_LABEL_PERSISTENT 2 12 Wave1Turn0}
	{TARGET Wave1 2 12}
	{SET_LABEL_PERSISTENT 4 13 Wave2Turn4}
	{TARGET Wave2 4 13}
	{SET_LABEL_PERSISTENT 2 14 Wave3Turn7}
	{TARGET Wave3 2 14}
	{SET_LABEL_PERSISTENT 4 15 Challenge}
	{TARGET CWave 4 15}
	{SET_LABEL_PERSISTENT 2 16 Wave5Turn15}
	{TARGET Wave5 2 16}
	{SET_LABEL_PERSISTENT 4 17 Wave6Turn18}
	{TARGET Wave6 4 17}
	{SET_LABEL_PERSISTENT 2 18 Wave7Turn21}
	{TARGET Wave7 2 18}
	{SET_LABEL_PERSISTENT 4 19 Challenge}
	{TARGET CWave 4 19}
	{SET_LABEL_PERSISTENT 2 20 Wave9Turn28}
	{TARGET Wave9 2 20}
	{SET_LABEL_PERSISTENT 4 21 Wave10Turn31}
	{TARGET Wave10 4 21}
	{SET_LABEL_PERSISTENT 2 22 Wave11Turn34}
	{TARGET Wave11 2 22}
	{SET_LABEL_PERSISTENT 4 23 Challenge}
	{TARGET CWave 4 23}
	{SET_LABEL_PERSISTENT 2 24 Wave13Turn40}
	{TARGET Wave13 2 24}
	{SET_LABEL_PERSISTENT 4 25 Wave14Turn43}
	{TARGET Wave14 4 25}
	{SET_LABEL_PERSISTENT 2 26 Wave15Turn46}
	{TARGET Wave15 2 26}
	{SET_LABEL_PERSISTENT 4 27 Challenge}
	{TARGET CWave 4 27}
	{SET_LABEL_PERSISTENT 2 28 Wave17Turn54}
	{TARGET Wave17 2 28}
	{SET_LABEL_PERSISTENT 4 29 Wave18Turn57}
	{TARGET Wave18 4 29}
	{SET_LABEL_PERSISTENT 2 30 Wave19Turn60}
	{TARGET Wave19 2 30}
	{SET_LABEL_PERSISTENT 4 31 Challenge}
	{TARGET CWave 4 31}
        {SET_LABEL_PERSISTENT 2 32 Wave21Turn67}
	{TARGET Wave21 2 32}
	{SET_LABEL_PERSISTENT 4 33 Wave22Turn70}
	{TARGET Wave22 4 33}
        {SET_LABEL_PERSISTENT 2 34 Wave23Turn73}
	{TARGET Wave23 2 34}
	{SET_LABEL_PERSISTENT 4 35 Challenge}
	{TARGET CWave 4 35}
        {SET_LABEL_PERSISTENT 2 36 "Final Challenge"}
	{TARGET CWave 2 36}

 [objectives]
  side=0
  summary= _ "Wesnoth Tower Defense"
  [objective]
   description= _ "Destroy all the attackers
"
   condition=win
  [/objective]
  [objective]
   description= _ "(10+(10*#ofplayer)) enemies make it to the very center
"
   condition=lose
  [/objective]
 [/objectives]
[/event]

	[event]
		name=start
        [message]
             speaker=narrator
             message= _ "Good luck, don't let the mobs get you. New players please right click on The Tower in the center during your turn to read the instructions."
            image=wesnoth-icon.png
        [/message]
     [/event]

###############################################    Building
	[event]
	    name=side turn
            first_time_only=no
		[set_menu_item]
			id=deployarcher
			description=_ "Deploy archers (20gold)"
			[filter_location]
			     [not]
				terrain=Wwf
			     [/not]
			     [not]
				terrain=Xu
			     [/not]
			[/filter_location]
			[show_if]
				[not]
					[have_unit]
						x,y=$x1,$y1
						count=1
					[/have_unit]
				[/not]
			[/show_if]
			[command]
				[store_gold]
					side=$side_number
					variable=gold
				[/store_gold]
				[if]
					[variable]
						name=gold
						greater_than_equal_to=20
					[/variable]
					[then]
					[if]
                                           [variable]
						name=side_number
						equals=1
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-20
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p1basic
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=archer0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p1basic
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=archer1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p1basic
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=archer2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p1basic
                                                         equals=3
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=archer3
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
					[/then]
					[/if]

					[if]
                                           [variable]
						name=side_number
						equals=2
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-20
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p2basic
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=archer0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p2basic
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=archer1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p2basic
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=archer2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p2basic
                                                         equals=3
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=archer3
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
					[/then]
					[/if]

					[if]
                                           [variable]
						name=side_number
						equals=3
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-20
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p3basic
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=archer0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p3basic
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=archer1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p3basic
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=archer2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p3basic
                                                         equals=3
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=archer3
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
					[/then]
					[/if]

					[if]
                                           [variable]
						name=side_number
						equals=4
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-20
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p4basic
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=archer0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p4basic
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=archer1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p4basic
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=archer2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p4basic
                                                         equals=3
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=archer3
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
					[/then]
					[/if]

                                                [store_unit]
						    [filter]
                                                    x,y=$x1,$y1
						    [/filter]
                                                    variable=new_tower
						    kill=yes
                                                [/store_unit]
                                                [set_variable]
                                                    name=new_tower.side
                                                    add=5
                                                [/set_variable]
                                                [unstore_unit]
						    variable=new_tower
                                                [/unstore_unit]
						[sound]
							name=mace.wav
						[/sound]
					[/then]
				[/if]
				[else]
 				[message]
				    speaker=narrator
				    side=$side_number
				    message=_ "not enough gold"
				    image=wesnoth-icon.png
				[/message]
				[/else]
			[/command]
		[/set_menu_item]
		[set_menu_item]
			id=deploybladesmen
			description=_ "Deploy bladesmen (20gold)"
			[filter_location]
			     [not]
				terrain=Wwf
			     [/not]
			     [not]
				terrain=Xu
			     [/not]
			[/filter_location]
			[show_if]
				[not]
					[have_unit]
						x,y=$x1,$y1
						count=1
					[/have_unit]
				[/not]
			[/show_if]
			[command]
				[store_gold]
					side=$side_number
					variable=gold
				[/store_gold]
				[if]
					[variable]
						name=gold
						greater_than_equal_to=20
					[/variable]
					[then]
					[if]
                                           [variable]
						name=side_number
						equals=1
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-20
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p1basic
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=blade0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p1basic
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=blade1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p1basic
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=blade2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p1basic
                                                         equals=3
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=blade3
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
					[/then]
					[/if]

					[if]
                                           [variable]
						name=side_number
						equals=2
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-20
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p2basic
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=blade0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p2basic
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=blade1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p2basic
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=blade2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p2basic
                                                         equals=3
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=blade3
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
					[/then]
					[/if]

					[if]
                                           [variable]
						name=side_number
						equals=3
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-20
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p3basic
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=blade0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p3basic
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=blade1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p3basic
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=blade2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p3basic
                                                         equals=3
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=blade3
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
					[/then]
					[/if]

					[if]
                                           [variable]
						name=side_number
						equals=4
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-20
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p4basic
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=blade0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p4basic
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=blade1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p4basic
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=blade2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p4basic
                                                         equals=3
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=blade3
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
					[/then]
					[/if]

                                                [store_unit]
						    [filter]
                                                    x,y=$x1,$y1
						    [/filter]
                                                    variable=new_tower
						    kill=yes
                                                [/store_unit]
                                                [set_variable]
                                                    name=new_tower.side
                                                    add=5
                                                [/set_variable]
                                                [unstore_unit]
						    variable=new_tower
                                                [/unstore_unit]
						[sound]
							name=mace.wav
						[/sound]
					[/then]
				[/if]
				[else]
 				[message]
				    speaker=narrator
				    side=side_number
				    message=_ "not enough gold"
				    image=wesnoth-icon.png
				[/message]
				[/else]
			[/command]
		[/set_menu_item]

		[set_menu_item]
			id=deploycrusher
			description=_ "Deploy crusher (20gold)"
			[filter_location]
			     [not]
				terrain=Wwf
			     [/not]
			     [not]
				terrain=Xu
			     [/not]
			[/filter_location]
			[show_if]
				[not]
					[have_unit]
						x,y=$x1,$y1
						count=1
					[/have_unit]
				[/not]
			[/show_if]
			[command]
				[store_gold]
					side=$side_number
					variable=gold
				[/store_gold]
				[if]
					[variable]
						name=gold
						greater_than_equal_to=20
					[/variable]
					[then]
					[if]
                                           [variable]
						name=side_number
						equals=1
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-20
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p1basic
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=crush0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p1basic
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=crush1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p1basic
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=crush2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p1basic
                                                         equals=3
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=crush3
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
					[/then]
					[/if]

					[if]
                                           [variable]
						name=side_number
						equals=2
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-20
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p2basic
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=crush0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p2basic
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=crush1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p2basic
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=crush2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p2basic
                                                         equals=3
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=crush3
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
					[/then]
					[/if]

					[if]
                                           [variable]
						name=side_number
						equals=3
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-20
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p3basic
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=crush0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p3basic
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=crush1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p3basic
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=crush2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p3basic
                                                         equals=3
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=crush3
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
					[/then]
					[/if]

					[if]
                                           [variable]
						name=side_number
						equals=4
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-20
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p4basic
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=crush0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p4basic
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=crush1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p4basic
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=crush2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p4basic
                                                         equals=3
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=crush3
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
					[/then]
					[/if]

                                                [store_unit]
						    [filter]
                                                    x,y=$x1,$y1
						    [/filter]
                                                    variable=new_tower
						    kill=yes
                                                [/store_unit]
                                                [set_variable]
                                                    name=new_tower.side
                                                    add=5
                                                [/set_variable]
                                                [unstore_unit]
						    variable=new_tower
                                                [/unstore_unit]
						[sound]
							name=mace.wav
						[/sound]
					[/then]
				[/if]
				[else]
 				[message]
				    speaker=narrator
				    side=side_number
				    message=_ "not enough gold"
				    image=wesnoth-icon.png
				[/message]
				[/else]
			[/command]
		[/set_menu_item]

		[set_menu_item]
			id=deployicecaster
			description=_ "Deploy Icecaster (40gold)"
			[filter_location]
			     [not]
				terrain=Wwf
			     [/not]
			     [not]
				terrain=Xu
			     [/not]
			[/filter_location]
			[show_if]
				[not]
					[have_unit]
						x,y=$x1,$y1
						count=1
					[/have_unit]
				[/not]
			[/show_if]
			[command]
				[store_gold]
					side=$side_number
					variable=gold
				[/store_gold]
				[if]
					[variable]
						name=gold
						greater_than_equal_to=40
					[/variable]
					[then]
					[if]
                                           [variable]
						name=side_number
						equals=1
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-40
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p1ice
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=ice0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p1ice
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=ice1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p1ice
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=ice2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
					[/then]
					[/if]

					[if]
                                           [variable]
						name=side_number
						equals=2
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-40
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p2ice
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=ice0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p2ice
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=ice1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p2ice
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=ice2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
					[/then]
					[/if]

					[if]
                                           [variable]
						name=side_number
						equals=3
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-40
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p3ice
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=ice0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p3ice
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=ice1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p3ice
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=ice2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p3ice
                                                         equals=3
                                                     [/variable]
                                                [/if]
					[/then]
					[/if]

					[if]
                                           [variable]
						name=side_number
						equals=4
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-40
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p4ice
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=ice0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p4ice
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=ice1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p4ice
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=ice2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
					[/then]
					[/if]

                                                [store_unit]
						    [filter]
                                                    x,y=$x1,$y1
						    [/filter]
                                                    variable=new_tower
						    kill=yes
                                                [/store_unit]
                                                [set_variable]
                                                    name=new_tower.side
                                                    add=5
                                                [/set_variable]
                                                [unstore_unit]
						    variable=new_tower
                                                [/unstore_unit]
						[sound]
							name=mace.wav
						[/sound]
					[/then]
				[/if]
				[else]
 				[message]
				    speaker=narrator
				    side=side_number
				    message=_ "not enough gold"
				    image=wesnoth-icon.png
				[/message]
				[/else]
			[/command]
		[/set_menu_item]

		[set_menu_item]
			id=deployfirecaster
			description=_ "Deploy Firecaster (60gold)"
			[filter_location]
			     [not]
				terrain=Wwf
			     [/not]
			     [not]
				terrain=Xu
			     [/not]
			[/filter_location]
			[show_if]
				[not]
					[have_unit]
						x,y=$x1,$y1
						count=1
					[/have_unit]
				[/not]
			[/show_if]
			[command]
				[store_gold]
					side=$side_number
					variable=gold
				[/store_gold]
				[if]
					[variable]
						name=gold
						greater_than_equal_to=60
					[/variable]
					[then]
					[if]
                                           [variable]
						name=side_number
						equals=1
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-60
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p1fire
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=fire0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p1fire
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=fire1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p1fire
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=fire2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
					[/then]
					[/if]

					[if]
                                           [variable]
						name=side_number
						equals=2
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-60
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p2fire
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=fire0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p2fire
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=fire1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p2fire
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=fire2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
					[/then]
					[/if]

					[if]
                                           [variable]
						name=side_number
						equals=3
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-60
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p3fire
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=fire0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p3fire
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=fire1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p3fire
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=fire2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p3fire
                                                         equals=3
                                                     [/variable]
                                                [/if]
					[/then]
					[/if]

					[if]
                                           [variable]
						name=side_number
						equals=4
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-60
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p4fire
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=fire0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p4fire
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=fire1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p4fire
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=fire2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
					[/then]
					[/if]

                                                [store_unit]
						    [filter]
                                                    x,y=$x1,$y1
						    [/filter]
                                                    variable=new_tower
						    kill=yes
                                                [/store_unit]
                                                [set_variable]
                                                    name=new_tower.side
                                                    add=5
                                                [/set_variable]
                                                [unstore_unit]
						    variable=new_tower
                                                [/unstore_unit]
						[sound]
							name=mace.wav
						[/sound]
					[/then]
				[/if]
				[else]
				[/else]
			[/command]
		[/set_menu_item]

		[set_menu_item]
			id=deploystealth
			description=_ "Deploy Stealth (80gold)"
			[filter_location]
			     [not]
				terrain=Wwf
			     [/not]
			     [not]
				terrain=Xu
			     [/not]
			[/filter_location]
			[show_if]
				[not]
					[have_unit]
						x,y=$x1,$y1
						count=1
					[/have_unit]
				[/not]
			[/show_if]
			[command]
				[store_gold]
					side=$side_number
					variable=gold
				[/store_gold]
				[if]
					[variable]
						name=gold
						greater_than_equal_to=80
					[/variable]
					[then]
					[if]
                                           [variable]
						name=side_number
						equals=1
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-80
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p1stealth
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=stealth0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p1stealth
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=stealth1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p1stealth
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=stealth2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
					[/then]
					[/if]

					[if]
                                           [variable]
						name=side_number
						equals=2
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-80
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p2stealth
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=stealth0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p2stealth
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=stealth1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p2stealth
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=stealth2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
					[/then]
					[/if]

					[if]
                                           [variable]
						name=side_number
						equals=3
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-80
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p3stealth
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=stealth0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p3stealth
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=stealth1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p3stealth
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=stealth2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p3stealth
                                                         equals=3
                                                     [/variable]
                                                [/if]
					[/then]
					[/if]

					[if]
                                           [variable]
						name=side_number
						equals=4
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-80
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p4stealth
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=stealth0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p4stealth
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=stealth1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p4stealth
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=stealth2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
					[/then]
					[/if]

                                                [store_unit]
						    [filter]
                                                    x,y=$x1,$y1
						    [/filter]
                                                    variable=new_tower
						    kill=yes
                                                [/store_unit]
                                                [set_variable]
                                                    name=new_tower.side
                                                    add=5
                                                [/set_variable]
                                                [unstore_unit]
						    variable=new_tower
                                                [/unstore_unit]
						[sound]
							name=mace.wav
						[/sound]
					[/then]
				[/if]
			[/command]
		[/set_menu_item]

		
		[set_menu_item]
			id=deployzadvanced
			description=_ "Deploy Advanced (100gold)"
			[filter_location]
			     [not]
				terrain=Wwf
			     [/not]
			     [not]
				terrain=Xu
			     [/not]
			[/filter_location]
			[show_if]
				[not]
					[have_unit]
						x,y=$x1,$y1
						count=1
					[/have_unit]
				[/not]
			[/show_if]
			
			[command]

				[store_gold]
					side=$side_number
					variable=gold
				[/store_gold]
			   [if]
					[variable]
						name=gold
						greater_than_equal_to=100
					[/variable]
					[then]
					[message]
						side=$side_number
                                                speaker=narrator
							[option]
							  message= _ "Cancel"
							  [command]

							  [/command]
							[/option]
							
				[option]
							  message= _ "Deploy Champion(100)"
				[command]
 	
				[store_gold]
					side=$side_number
					variable=gold
				[/store_gold]
				[if]
					[variable]
						name=gold
						greater_than_equal_to=100
					[/variable]
					[then]
					[if]
                       [variable]
						name=side_number
						equals=1
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-100
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p1champion
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=champion0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p1champion
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=champion1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p1champion
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=champion2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
					[/then]
					[/if]

					[if]
                                           [variable]
						name=side_number
						equals=2
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-100
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p2champion
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=champion0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p2champion
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=champion1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p2champion
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=champion2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
					[/then]
					[/if]

					[if]
                                           [variable]
						name=side_number
						equals=3
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-100
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p3champion
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=champion0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p3champion
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=champion1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p3champion
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=champion2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p3champion
                                                         equals=3
                                                     [/variable]
                                                [/if]
					[/then]
					[/if]

					[if]
                                           [variable]
						name=side_number
						equals=4
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-100
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p4champion
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=champion0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p4champion
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=champion1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p4champion
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=champion2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
					[/then]
					[/if]

                                                [store_unit]
						    [filter]
                                                    x,y=$x1,$y1
						    [/filter]
                                                    variable=new_tower
						    kill=yes
                                                [/store_unit]
                                                [set_variable]
                                                    name=new_tower.side
                                                    add=5
                                                [/set_variable]
                                                [unstore_unit]
						    variable=new_tower
                                                [/unstore_unit]
						[sound]
							name=mace.wav
						[/sound]
					[/then]
				[/if]
							  [/command]
							[/option]
							
							
										[option]
							  message= _ "Deploy Blaster(100)"
				[command]
 	
				[store_gold]
					side=$side_number
					variable=gold
				[/store_gold]
				[if]
					[variable]
						name=gold
						greater_than_equal_to=100
					[/variable]
					[then]
					[if]
                                           [variable]
						name=side_number
						equals=1
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-100
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p1blaster
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=blaster0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p1blaster
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=blaster1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p1blaster
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=blaster2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
					[/then]
					[/if]

					[if]
                                           [variable]
						name=side_number
						equals=2
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-100
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p2blaster
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=blaster0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p2blaster
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=blaster1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p2blaster
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=blaster2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
					[/then]
					[/if]

					[if]
                                           [variable]
						name=side_number
						equals=3
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-100
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p3blaster
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=blaster0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p3blaster
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=blaster1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p3blaster
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=blaster2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p3blaster
                                                         equals=3
                                                     [/variable]
                                                [/if]
					[/then]
					[/if]

					[if]
                                           [variable]
						name=side_number
						equals=4
					   [/variable]
                                           [then]
						[gold]
							side=$side_number
							amount=-100
						[/gold]
                                                [if]
                                                     [variable]
                                                         name=p4blaster
                                                         equals=0
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=blaster0
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p4blaster
                                                         equals=1
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=blaster1
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
                                                [if]
                                                     [variable]
                                                         name=p4blaster
                                                         equals=2
                                                     [/variable]
                                                     [then]
				     	                 [unit]
							     type=blaster2
							     x,y=$x1,$y1
							     side=$side_number
				 		         [/unit]
                                                     [/then]
                                                [/if]
					[/then]
					[/if]

                                                [store_unit]
						    [filter]
                                                    x,y=$x1,$y1
						    [/filter]
                                                    variable=new_tower
						    kill=yes
                                                [/store_unit]
                                                [set_variable]
                                                    name=new_tower.side
                                                    add=5
                                                [/set_variable]
                                                [unstore_unit]
						    variable=new_tower
                                                [/unstore_unit]
						[sound]
							name=mace.wav
						[/sound]
					[/then]
				[/if]
							  [/command]
							[/option]
							
							


				    [/message]

					[/then]
				
			   [/if]

			[/command]

		[/set_menu_item]
	[/event]



################################################################################ Upgrades
#define BASIC_UG PLAYER
	[event]
	    name=side turn
            first_time_only=no
            [if]
            [variable]
                name=side_number
                equals={PLAYER}
            [/variable]
            [then]
		[set_menu_item]
			id={PLAYER}upgradeAbasic1
			description=_ "Upgrade Basic towers (75 gold)"
			[show_if]
				[have_unit]
					x,y=$x1,$y1
					type=Spearman
					count=1
				[/have_unit]
				[variable]
					name=p{PLAYER}basic
					equals=0
				[/variable]
				[variable]
					name=side_number
					equals={PLAYER}
				[/variable]
			[/show_if]
			[command]
				[store_gold]
					side=$side_number
					variable=gold
				[/store_gold]
				[if]
					[variable]
						name=gold
						greater_than_equal_to=75
					[/variable]
					[then]
						[gold]
							side=$side_number
							amount=-75
						[/gold]
						[set_variable]
							name=p{PLAYER}basic
							add=1
						[/set_variable]
					[/then]
				[/if]
			[/command]
		[/set_menu_item]
                [/then]
                [/if]
	[/event]

	[event]
	    name=side turn
            first_time_only=no
            [if]
            [variable]
                name=side_number
                equals={PLAYER}
            [/variable]
            [then]
		[set_menu_item]
			id=p{PLAYER}upgradeAbasic2
			description=_ "Upgrade Basic towers (150 gold)"
			[show_if]
				[have_unit]
					x,y=$x1,$y1
					type=Spearman
					count=1
				[/have_unit]
				[variable]
					name=p{PLAYER}basic
					equals=1
				[/variable]
				[variable]
					name=side_number
					equals={PLAYER}
				[/variable]
			[/show_if]
			[command]
				[store_gold]
					side=$side_number
					variable=gold
				[/store_gold]
				[if]
					[variable]
						name=gold
						greater_than_equal_to=150
					[/variable]
					[then]
						[gold]
							side=$side_number
							amount=-150
						[/gold]
						[set_variable]
							name=p{PLAYER}basic
							add=1
						[/set_variable]
					[/then]
				[/if]
			[/command]
		[/set_menu_item]
	       [/then]
	     [/if]
	[/event]

	[event]
	    name=side turn
            first_time_only=no
            [if]
            [variable]
                name=side_number
                equals={PLAYER}
            [/variable]
            [then]
		[set_menu_item]
			id=p{PLAYER}upgradeAbasic3
			description=_ "Upgrade Basic towers (250 gold)"
			[show_if]
				[have_unit]
					x,y=$x1,$y1
					type=Spearman
					count=1
				[/have_unit]
				[variable]
					name=p{PLAYER}basic
					equals=2
				[/variable]
				[variable]
					name=side_number
					equals={PLAYER}
				[/variable]
			[/show_if]
			[command]
				[store_gold]
					side=$side_number
					variable=gold
				[/store_gold]
				[if]
					[variable]
						name=gold
						greater_than_equal_to=250
					[/variable]
					[then]
						[gold]
							side=$side_number
							amount=-250
						[/gold]
						[set_variable]
							name=p{PLAYER}basic
							add=1
						[/set_variable]
					[/then]
				[/if]
			[/command]
		[/set_menu_item]
               [/then]
           [/if]
	[/event]
#enddef

#define STEALTH_UG PLAYER
	[event]
	    name=side turn
            first_time_only=no
            [if]
            [variable]
                name=side_number
                equals={PLAYER}
            [/variable]
            [then]
		[set_menu_item]
			id={PLAYER}upgradeDstealth1
			description=_ "Upgrade Stealth towers (125 gold)"
			[show_if]
				[have_unit]
					x,y=$x1,$y1
					type=Spearman
					count=1
				[/have_unit]
				[variable]
					name=p{PLAYER}stealth
					equals=0
				[/variable]
				[variable]
					name=side_number
					equals={PLAYER}
				[/variable]
			[/show_if]
			[command]
				[store_gold]
					side=$side_number
					variable=gold
				[/store_gold]
				[if]
					[variable]
						name=gold
						greater_than_equal_to=125
					[/variable]
					[then]
						[gold]
							side=$side_number
							amount=-125
						[/gold]
						[set_variable]
							name=p{PLAYER}stealth
							add=1
						[/set_variable]
					[/then]
				[/if]
			[/command]
		[/set_menu_item]
                [/then]
                [/if]
	[/event]

	[event]
	    name=side turn
            first_time_only=no
            [if]
            [variable]
                name=side_number
                equals={PLAYER}
            [/variable]
            [then]
		[set_menu_item]
			id=p{PLAYER}upgradeDstealth2
			description=_ "Upgrade Stealth towers (250 gold)"
			[show_if]
				[have_unit]
					x,y=$x1,$y1
					type=Spearman
					count=1
				[/have_unit]
				[variable]
					name=p{PLAYER}stealth
					equals=1
				[/variable]
				[variable]
					name=side_number
					equals={PLAYER}
				[/variable]
			[/show_if]
			[command]
				[store_gold]
					side=$side_number
					variable=gold
				[/store_gold]
				[if]
					[variable]
						name=gold
						greater_than_equal_to=250
					[/variable]
					[then]
						[gold]
							side=$side_number
							amount=-250
						[/gold]
						[set_variable]
							name=p{PLAYER}stealth
							add=1
						[/set_variable]
					[/then]
				[/if]
			[/command]
		[/set_menu_item]
	       [/then]
	     [/if]
	[/event]
#enddef


#define ICE_UG PLAYER
	[event]
	    name=side turn
            first_time_only=no
            [if]
            [variable]
                name=side_number
                equals={PLAYER}
            [/variable]
            [then]
		[set_menu_item]
			id={PLAYER}upgradeBice1
			description=_ "Upgrade Ice towers (75 gold)"
			[show_if]
				[have_unit]
					x,y=$x1,$y1
					type=Spearman
					count=1
				[/have_unit]
				[variable]
					name=p{PLAYER}ice
					equals=0
				[/variable]
				[variable]
					name=side_number
					equals={PLAYER}
				[/variable]
			[/show_if]
			[command]
				[store_gold]
					side=$side_number
					variable=gold
				[/store_gold]
				[if]
					[variable]
						name=gold
						greater_than_equal_to=75
					[/variable]
					[then]
						[gold]
							side=$side_number
							amount=-75
						[/gold]
						[set_variable]
							name=p{PLAYER}ice
							add=1
						[/set_variable]
					[/then]
				[/if]
			[/command]
		[/set_menu_item]
                [/then]
                [/if]
	[/event]

	[event]
	    name=side turn
            first_time_only=no
            [if]
            [variable]
                name=side_number
                equals={PLAYER}
            [/variable]
            [then]
		[set_menu_item]
			id=p{PLAYER}upgradeBice2
			description=_ "Upgrade Ice towers (200 gold)"
			[show_if]
				[have_unit]
					x,y=$x1,$y1
					type=Spearman
					count=1
				[/have_unit]
				[variable]
					name=p{PLAYER}ice
					equals=1
				[/variable]
				[variable]
					name=side_number
					equals={PLAYER}
				[/variable]
			[/show_if]
			[command]
				[store_gold]
					side=$side_number
					variable=gold
				[/store_gold]
				[if]
					[variable]
						name=gold
						greater_than_equal_to=200
					[/variable]
					[then]
						[gold]
							side=$side_number
							amount=-200
						[/gold]
						[set_variable]
							name=p{PLAYER}ice
							add=1
						[/set_variable]
					[/then]
				[/if]
			[/command]
		[/set_menu_item]
	       [/then]
	     [/if]
	[/event]
#enddef

#define FIRE_UG PLAYER
	[event]
	    name=side turn
            first_time_only=no
            [if]
            [variable]
                name=side_number
                equals={PLAYER}
            [/variable]
            [then]
		[set_menu_item]
			id={PLAYER}upgradeCfire1
			description=_ "Upgrade Fire towers (100 gold)"
			[show_if]
				[have_unit]
					x,y=$x1,$y1
					type=Spearman
					count=1
				[/have_unit]
				[variable]
					name=p{PLAYER}fire
					equals=0
				[/variable]
				[variable]
					name=side_number
					equals={PLAYER}
				[/variable]
			[/show_if]
			[command]
				[store_gold]
					side=$side_number
					variable=gold
				[/store_gold]
				[if]
					[variable]
						name=gold
						greater_than_equal_to=100
					[/variable]
					[then]
						[gold]
							side=$side_number
							amount=-100
						[/gold]
						[set_variable]
							name=p{PLAYER}fire
							add=1
						[/set_variable]
					[/then]
				[/if]
			[/command]
		[/set_menu_item]
                [/then]
                [/if]
	[/event]

	[event]
	    name=side turn
            first_time_only=no
            [if]
            [variable]
                name=side_number
                equals={PLAYER}
            [/variable]
            [then]
		[set_menu_item]
			id=p{PLAYER}upgradeCfire2
			description=_ "Upgrade Fire towers (250 gold)"
			[show_if]
				[have_unit]
					x,y=$x1,$y1
					type=Spearman
					count=1
				[/have_unit]
				[variable]
					name=p{PLAYER}fire
					equals=1
				[/variable]
				[variable]
					name=side_number
					equals={PLAYER}
				[/variable]
			[/show_if]
			[command]
				[store_gold]
					side=$side_number
					variable=gold
				[/store_gold]
				[if]
					[variable]
						name=gold
						greater_than_equal_to=250
					[/variable]
					[then]
						[gold]
							side=$side_number
							amount=-250
						[/gold]
						[set_variable]
							name=p{PLAYER}fire
							add=1
						[/set_variable]
					[/then]
				[/if]
			[/command]
		[/set_menu_item]
	       [/then]
	     [/if]
	[/event]
#enddef

#define CHAMP_UG PLAYER
	[event]
	    name=side turn
            first_time_only=no
            [if]
            [variable]
                name=side_number
                equals={PLAYER}
            [/variable]
            [then]
		[set_menu_item]
			id={PLAYER}upgradeZchampion1
			description=_ "Upgrade Champion towers (150 gold)"
			[show_if]
				[have_unit]
					x,y=$x1,$y1
					type=Spearman
					count=1
				[/have_unit]
				[variable]
					name=p{PLAYER}champion
					equals=0
				[/variable]
				[variable]
					name=side_number
					equals={PLAYER}
				[/variable]
			[/show_if]
			[command]
				[store_gold]
					side=$side_number
					variable=gold
				[/store_gold]
				[if]
					[variable]
						name=gold
						greater_than_equal_to=150
					[/variable]
					[then]
						[gold]
							side=$side_number
							amount=-150
						[/gold]
						[set_variable]
							name=p{PLAYER}champion
							add=1
						[/set_variable]
					[/then]
				[/if]
			[/command]
		[/set_menu_item]
                [/then]
                [/if]
	[/event]

	[event]
	    name=side turn
            first_time_only=no
            [if]
            [variable]
                name=side_number
                equals={PLAYER}
            [/variable]
            [then]
		[set_menu_item]
			id=p{PLAYER}upgradeZchampion2
			description=_ "Upgrade Champion towers (300 gold)"
			[show_if]
				[have_unit]
					x,y=$x1,$y1
					type=Spearman
					count=1
				[/have_unit]
				[variable]
					name=p{PLAYER}champion
					equals=1
				[/variable]
				[variable]
					name=side_number
					equals={PLAYER}
				[/variable]
			[/show_if]
			[command]
				[store_gold]
					side=$side_number
					variable=gold
				[/store_gold]
				[if]
					[variable]
						name=gold
						greater_than_equal_to=300
					[/variable]
					[then]
						[gold]
							side=$side_number
							amount=-300
						[/gold]
						[set_variable]
							name=p{PLAYER}champion
							add=1
						[/set_variable]
					[/then]
				[/if]
			[/command]
		[/set_menu_item]
	       [/then]
	     [/if]
	[/event]
#enddef

#define BLASTER_UG PLAYER
	[event]
	    name=side turn
            first_time_only=no
            [if]
            [variable]
                name=side_number
                equals={PLAYER}
            [/variable]
            [then]
		[set_menu_item]
			id={PLAYER}upgradeVblaster1
			description=_ "Upgrade Blaster towers (125 gold)"
			[show_if]
				[have_unit]
					x,y=$x1,$y1
					type=Spearman
					count=1
				[/have_unit]
				[variable]
					name=p{PLAYER}blaster
					equals=0
				[/variable]
				[variable]
					name=side_number
					equals={PLAYER}
				[/variable]
			[/show_if]
			[command]
				[store_gold]
					side=$side_number
					variable=gold
				[/store_gold]
				[if]
					[variable]
						name=gold
						greater_than_equal_to=125
					[/variable]
					[then]
						[gold]
							side=$side_number
							amount=-125
						[/gold]
						[set_variable]
							name=p{PLAYER}blaster
							add=1
						[/set_variable]
					[/then]
				[/if]
			[/command]
		[/set_menu_item]
                [/then]
                [/if]
	[/event]

	[event]
	    name=side turn
            first_time_only=no
            [if]
            [variable]
                name=side_number
                equals={PLAYER}
            [/variable]
            [then]
		[set_menu_item]
			id=p{PLAYER}upgradeVblaster2
			description=_ "Upgrade Blaster towers (275 gold)"
			[show_if]
				[have_unit]
					x,y=$x1,$y1
					type=Spearman
					count=1
				[/have_unit]
				[variable]
					name=p{PLAYER}blaster
					equals=1
				[/variable]
				[variable]
					name=side_number
					equals={PLAYER}
				[/variable]
			[/show_if]
			[command]
				[store_gold]
					side=$side_number
					variable=gold
				[/store_gold]
				[if]
					[variable]
						name=gold
						greater_than_equal_to=275
					[/variable]
					[then]
						[gold]
							side=$side_number
							amount=-275
						[/gold]
						[set_variable]
							name=p{PLAYER}blaster
							add=1
						[/set_variable]
					[/then]
				[/if]
			[/command]
		[/set_menu_item]
	       [/then]
	     [/if]
	[/event]
#enddef


	{BASIC_UG 1}
	{BASIC_UG 2}
	{BASIC_UG 3}
	{BASIC_UG 4}

	{ICE_UG 1}
	{ICE_UG 2}
	{ICE_UG 3}
	{ICE_UG 4}

	{FIRE_UG 1}
	{FIRE_UG 2}
	{FIRE_UG 3}
	{FIRE_UG 4}

	{STEALTH_UG 1}
	{STEALTH_UG 2}
	{STEALTH_UG 3}
	{STEALTH_UG 4}

	{CHAMP_UG 1}
	{CHAMP_UG 2}
	{CHAMP_UG 3}
	{CHAMP_UG 4}

	{BLASTER_UG 1}
	{BLASTER_UG 2}
	{BLASTER_UG 3}
	{BLASTER_UG 4}

	[event]
	    name=side turn
            first_time_only=no
		[set_menu_item]
			id=train
			description=_ "train unit (5gold->8xp)"
			[show_if]
				[have_unit]
					x,y=$x1,$y1
					side=6,7,8,9
					count=1
					canrecruit=no
				[/have_unit]
			[/show_if]
                        [command]
				[store_gold]
					side=$side_number
					variable=gold
				[/store_gold]
				[if]
					[variable]
						name=gold
						greater_than_equal_to=5
					[/variable]
					[then]
						[gold]
							side=$side_number
							amount=-5
						[/gold]
						[store_unit]
							[filter]
				  			       x,y=$x1,$y1
							[/filter]
							variable=trained
							kill=yes
						[/store_unit]
						[set_variable]
							name=trained.experience
							add=8
						[/set_variable]
				                [unstore_unit]
				                     variable=trained
				                     text=_ "trained"
				                     red,green,blue=100,100,204
		        		        [/unstore_unit]
						[sound]
						     name=fire.wav
						[/sound]  
					[/then]
				[/if]
                        [/command]                      
                [/set_menu_item]
                [set_menu_item]
			id=vEndow
			description=_ "endow unit (20gold->40xp)"
			[show_if]
				[have_unit]
					x,y=$x1,$y1
					side=6,7,8,9
					count=1
					canrecruit=no
				[/have_unit]
			[/show_if]
                        [command]
				[store_gold]
					side=$side_number
					variable=gold
				[/store_gold]
				[if]
					[variable]
						name=gold
						greater_than_equal_to=20
					[/variable]
					[then]
						[gold]
							side=$side_number
							amount=-20
						[/gold]
						[store_unit]
							[filter]
				  			       x,y=$x1,$y1
							[/filter]
							variable=trained
							kill=yes
						[/store_unit]
						[set_variable]
							name=trained.experience
							add=40
						[/set_variable]
				                [unstore_unit]
				                     variable=trained
				                     text=_ "Endowed"
				                     red,green,blue=100,100,204
		        		        [/unstore_unit]
						[sound]
						     name=magic-holy-3.ogg
						[/sound] 
					[/then]
				[/if]
                        [/command]                      
                [/set_menu_item]

########################################################################### Instructions

		[set_menu_item]
			id=instructions
			description=_ "Instructions"
			[show_if]
				[have_unit]
					type=TheTower
					x,y=$x1,$y1
				[/have_unit]
			[/show_if]
                        [command]
                             [message]
                                  side=$side_number
				  speaker=narrator
                                  message= _ "Welcome to Wesnoth Tower Defense
The goal of the game is quite simple, enemies appear on the outside of the map and will walk toward the center. It is your goal to prevent them from getting there. You do this by deploying stationary units referred to as towers. These towers will fight for themselves as the enemies run past them. When they slay enemies it will give you gold. For more information click any of the relevant menus."
				[option]
				  message= _ "Building Towers"
				  [command]
                                     [message]
                                         side=$side_number
                                         speaker=narrator
                                         message= _ "To build a tower, right click on a non-river ford, non-cavewall hex and select the tower you want."
                                         image=wesnoth-icon.png
                                     [/message]
				  [/command]
				[/option]
				[option]
				  message= _ "Upgrading towers"
				  [command]
                                     [message]
                                         side=$side_number
                                         speaker=narrator
                                         message= _ "There are two ways to upgrade towers. First of all you can upgrade individual towers by buying exp for them to do this right click on the tower you wish to upgrade and select train, or endow. This works well in the short term, but in the long term it is more efficient to purchase upgrade by right clicking on your spearman. These upgrades will make it so that every time you build a tower of the category listed, it will come onto the map at a higher level.(Basic towers are archers, crushers, and bladesmen)"
                                         image=wesnoth-icon.png
                                     [/message]
				  [/command]
				[/option]
				[option]
				  message= _ "About the Towers"
				  [command]
                                     [message]
                                         side=$side_number
                                         speaker=narrator
                                         message= _ "Archers and Crushers merely fight and become stronger as they level up. Bladesmen do less damage than either of them but come with the marksman ability and later on get the multistrike ability which might allow them to split up their attack. Ice towers slow down enemies and at higher levels gain multi-strike, and an ability which lets them automatically slow all enemies next to them. Fire towers deal good damage, and their attack splashes and deals damage to enemies adjacent to the enemy attacked. Stealth towers use poison and can hide. While hiding they will stop the first enemy to try to move past them. As they level up they become able to hide under more circumstances. Blaster towers have a ranged attack which is guaranteed to hit in addition to their normal attack (range 3) Champion Towers are unrivaled in ability to damage targets and have all three damage types by second level."
                                         image=wesnoth-icon.png
                                     [/message]
				  [/command]
				[/option]
				[option]
				  message= _ "General advice for new players"
				  [command]
                                     [message]
                                         side=$side_number
                                         speaker=narrator
                                         message= _ "Unless you want to try some gimmick strategy start by upgrading basic towers. Build some towers along the path to the center and try to keep some money in reserve for incase the enemy takes a different route or gets past your defense."
                                         image=wesnoth-icon.png
                                     [/message]
				  [/command]
				[/option]
                             [/message]
                        [/command]                      
                [/set_menu_item]

############################################################################## Sell Towers
		[set_menu_item]
			id=zselltower
			description=_ "sell tower for 50% of cost"
			[show_if]
				[variable]
				     side_number=1
				[/variable]
                                [and]
 				     [have_unit]
					x,y=$x1,$y1
					count=1
					side=6
					canrecruit=no
				     [/have_unit]                                    
                                [/and]
				[or]
				    [variable]
				        side_number=2
				    [/variable]
                                    [and]
 					[have_unit]
					      x,y=$x1,$y1
					      count=1
					      side=7
					      canrecruit=no
				        [/have_unit]                                    
                                     [/and]
				[/or]
			        [or]
				    [variable]
				        side_number=3
				    [/variable]
                                    [and]
 					[have_unit]
					      x,y=$x1,$y1
					      count=1
					      side=8
					      canrecruit=no
				        [/have_unit]                                    
                                     [/and]
				[/or]
			        [or]
				    [variable]
				        side_number=4
				    [/variable]
                                    [and]
 					[have_unit]
					      x,y=$x1,$y1
					      count=1
					      side=9
					      canrecruit=no
				        [/have_unit]                                    
                                     [/and]
				[/or]
			[/show_if]
                        [command]
				[store_unit]
					[filter]
					x,y=$x1,$y1						
					[/filter]
					kill=yes
					variable=sold
				[/store_unit]
				[gold]
					side=$side_number
					amount=$sold.cost
				[/gold]
				[sound]
				      name=zombie-attack.wav
				[/sound]
                        [/command]                      
                [/set_menu_item]
         [/event]

##################################################### The Mobs

#define WAVEST TURN WAVE
	[event]
		name=turn {TURN}
               	[unit]
		      type=Wave{WAVE}
		      x,y=1,3
	              side=5
		[/unit]
               	[unit]
		      type=Wave{WAVE}
		      x,y=1,4
	              side=5
		[/unit]
               	[unit]
		      type=Wave{WAVE}
		      x,y=1,5
	              side=5
		[/unit]
               	[unit]
		      type=Wave{WAVE}
		      x,y=2,2
	              side=5
		[/unit]
               	[unit]
		      type=Wave{WAVE}
		      x,y=3,2
	              side=5
		[/unit]
               	[unit]
		      type=Wave{WAVE}
		      x,y=4,2
	              side=5
		[/unit]
               	[unit]
		      type=Wave{WAVE}
		      x,y=5,3
	              side=5
		[/unit]
                [if]
                     [variable]
                         name=players
			 greater_than=1
                     [/variable]

                     [then]
               	[unit]
		      type=Wave{WAVE}
		      x,y=45,3
	              side=5
		[/unit]
               	[unit]
		      type=Wave{WAVE}
		      x,y=45,4
	              side=5
		[/unit]
               	[unit]
		      type=Wave{WAVE}
		      x,y=45,5
	              side=5
		[/unit]
               	[unit]
		      type=Wave{WAVE}
		      x,y=44,2
	              side=5
		[/unit]
               	[unit]
		      type=Wave{WAVE}
		      x,y=43,2
	              side=5
		[/unit]
               	[unit]
		      type=Wave{WAVE}
		      x,y=42,2
	              side=5
		[/unit]
               	[unit]
		      type=Wave{WAVE}
		      x,y=41,3
	              side=5
		[/unit]
                     [/then]
		[/if]

                [if]
                     [variable]
                         name=players
			 greater_than=2
                     [/variable]

                     [then]
               	[unit]
		      type=Wave{WAVE}
		      x,y=1,44
	              side=5
		[/unit]
               	[unit]
		      type=Wave{WAVE}
		      x,y=1,45
	              side=5
		[/unit]
               	[unit]
		      type=Wave{WAVE}
		      x,y=1,46
	              side=5
		[/unit]
               	[unit]
		      type=Wave{WAVE}
		      x,y=2,46
	              side=5
		[/unit]
               	[unit]
		      type=Wave{WAVE}
		      x,y=3,47
	              side=5
		[/unit]
               	[unit]
		      type=Wave{WAVE}
		      x,y=4,46
	              side=5
		[/unit]
               	[unit]
		      type=Wave{WAVE}
		      x,y=5,46
	              side=5
		[/unit]
                     [/then]
		[/if]

                [if]
                     [variable]
                         name=players
			 greater_than=3
                     [/variable]

                     [then]
               	[unit]
		      type=Wave{WAVE}
		      x,y=45,44
	              side=5
		[/unit]
               	[unit]
		      type=Wave{WAVE}
		      x,y=45,45
	              side=5
		[/unit]
               	[unit]
		      type=Wave{WAVE}
		      x,y=45,46
	              side=5
		[/unit]
               	[unit]
		      type=Wave{WAVE}
		      x,y=44,46
	              side=5
		[/unit]
               	[unit]
		      type=Wave{WAVE}
		      x,y=43,47
	              side=5
		[/unit]
               	[unit]
		      type=Wave{WAVE}
		      x,y=42,46
	              side=5
		[/unit]
               	[unit]
		      type=Wave{WAVE}
		      x,y=41,46
	              side=5
		[/unit]
                     [/then]
		[/if]
	[/event]
#enddef


##################################################### MOB MOVE

[event]
      name=turn refresh
      first_time_only=no
      [if]
         [variable]
            name=side_number
            equals=5
         [/variable]
         [then]
            [store_unit]
               [filter]
                  side=5
               [/filter]
               variable=unit_array
               kill=no
            [/store_unit]
            {FOREACH unit_array u}
               [set_variable]
                  name=unit_array[$u].goto_x
                  value=23
               [/set_variable]
               [set_variable]
                     name=unit_array[$u].goto_y
                  value=24
               [/set_variable]  
               [unstore_unit]
                      variable=unit_array[$u]
               [/unstore_unit]
            {NEXT u}
         [/then]
      [/if]
   [/event]


############################################################ THE WAVES

{WAVEST 1 1}
{WAVEST 4 2}
{WAVEST 7 3}

	[event]
		name=turn 11
               	[unit]
		      type=Wave4a
		      x,y=1,3
	              side=5
		[/unit]
               	[unit]
		      type=Wave4b
		      x,y=1,5
	              side=5
		[/unit]
               	[unit]
		      type=Wave4c
		      x,y=3,2
	              side=5
		[/unit]
               	[unit]
		      type=Wave4d
		      x,y=5,3
	              side=5
		[/unit]
                [if]
                     [variable]
                         name=players
			 greater_than=1
                     [/variable]

                     [then]
               	[unit]
		      type=Wave4a
		      x,y=45,3
	              side=5
		[/unit]
               	[unit]
		      type=Wave4b
		      x,y=45,5
	              side=5
		[/unit]

               	[unit]
		      type=Wave4c
		      x,y=43,2
	              side=5
		[/unit]

               	[unit]
		      type=Wave4d
		      x,y=41,3
	              side=5
		[/unit]
                     [/then]
		[/if]

                [if]
                     [variable]
                         name=players
			 greater_than=2
                     [/variable]

                     [then]
               	[unit]
		      type=Wave4a
		      x,y=1,44
	              side=5
		[/unit]
               	[unit]
		      type=Wave4b
		      x,y=1,46
	              side=5
		[/unit]
               	[unit]
		      type=Wave4c
		      x,y=3,47
	              side=5
		[/unit]
               	[unit]
		      type=Wave4d
		      x,y=5,46
	              side=5
		[/unit]
                     [/then]
		[/if]

                [if]
                     [variable]
                         name=players
			 greater_than=3
                     [/variable]

                     [then]
               	[unit]
		      type=Wave4a
		      x,y=45,44
	              side=5
		[/unit]
               	[unit]
		      type=Wave4b
		      x,y=45,46
	              side=5
		[/unit]
               	[unit]
		      type=Wave4c
		      x,y=43,47
	              side=5
		[/unit]
               	[unit]
		      type=Wave4d
		      x,y=41,46
	              side=5
		[/unit]
                     [/then]
		[/if]
	[/event]

	[event]
		name=turn 38
               	[unit]
		      type=Wave12a
		      x,y=1,3
	              side=5
		[/unit]
               	[unit]
		      type=Wave12b
		      x,y=1,5
	              side=5
		[/unit]
               	[unit]
		      type=Wave12c
		      x,y=3,2
	              side=5
		[/unit]
               	[unit]
		      type=Wave12d
		      x,y=5,3
	              side=5
		[/unit]
                [if]
                     [variable]
                         name=players
			 greater_than=1
                     [/variable]

                     [then]
               	[unit]
		      type=Wave12a
		      x,y=45,3
	              side=5
		[/unit]
               	[unit]
		      type=Wave12b
		      x,y=45,5
	              side=5
		[/unit]

               	[unit]
		      type=Wave12c
		      x,y=43,2
	              side=5
		[/unit]

               	[unit]
		      type=Wave12d
		      x,y=41,3
	              side=5
		[/unit]
                     [/then]
		[/if]

                [if]
                     [variable]
                         name=players
			 greater_than=2
                     [/variable]

                     [then]
               	[unit]
		      type=Wave12a
		      x,y=1,44
	              side=5
		[/unit]
               	[unit]
		      type=Wave12b
		      x,y=1,46
	              side=5
		[/unit]
               	[unit]
		      type=Wave12c
		      x,y=3,47
	              side=5
		[/unit]
               	[unit]
		      type=Wave12d
		      x,y=5,46
	              side=5
		[/unit]
                     [/then]
		[/if]

                [if]
                     [variable]
                         name=players
			 greater_than=3
                     [/variable]

                     [then]
               	[unit]
		      type=Wave12a
		      x,y=45,44
	              side=5
		[/unit]
               	[unit]
		      type=Wave12b
		      x,y=45,46
	              side=5
		[/unit]
               	[unit]
		      type=Wave12c
		      x,y=43,47
	              side=5
		[/unit]
               	[unit]
		      type=Wave12d
		      x,y=41,46
	              side=5
		[/unit]
                     [/then]
		[/if]
	[/event]

	[event]
		name=turn 50
               	[unit]
		      type=Wave16a
		      x,y=1,3
	              side=5
		[/unit]
               	[unit]
		      type=Wave16b
		      x,y=1,5
	              side=5
		[/unit]
               	[unit]
		      type=Wave16c
		      x,y=3,2
	              side=5
		[/unit]
               	[unit]
		      type=Wave16d
		      x,y=5,3
	              side=5
		[/unit]
                [if]
                     [variable]
                         name=players
			 greater_than=1
                     [/variable]

                     [then]
               	[unit]
		      type=Wave16a
		      x,y=45,3
	              side=5
		[/unit]
               	[unit]
		      type=Wave16b
		      x,y=45,5
	              side=5
		[/unit]

               	[unit]
		      type=Wave16c
		      x,y=43,2
	              side=5
		[/unit]

               	[unit]
		      type=Wave16d
		      x,y=41,3
	              side=5
		[/unit]
                     [/then]
		[/if]

                [if]
                     [variable]
                         name=players
			 greater_than=2
                     [/variable]

                     [then]
               	[unit]
		      type=Wave16a
		      x,y=1,44
	              side=5
		[/unit]
               	[unit]
		      type=Wave16b
		      x,y=1,46
	              side=5
		[/unit]
               	[unit]
		      type=Wave16c
		      x,y=3,47
	              side=5
		[/unit]
               	[unit]
		      type=Wave16d
		      x,y=5,46
	              side=5
		[/unit]
                     [/then]
		[/if]

                [if]
                     [variable]
                         name=players
			 greater_than=3
                     [/variable]

                     [then]
               	[unit]
		      type=Wave16a
		      x,y=45,44
	              side=5
		[/unit]
               	[unit]
		      type=Wave16b
		      x,y=45,46
	              side=5
		[/unit]
               	[unit]
		      type=Wave16c
		      x,y=43,47
	              side=5
		[/unit]
               	[unit]
		      type=Wave16d
		      x,y=41,46
	              side=5
		[/unit]
                     [/then]
		[/if]
	[/event]

	[event]
		name=turn 64
               	[unit]
		      type=Wave20a
		      x,y=1,3
	              side=5
		[/unit]
               	[unit]
		      type=Wave20b
		      x,y=1,5
	              side=5
		[/unit]
               	[unit]
		      type=Wave20c
		      x,y=3,2
	              side=5
		[/unit]
               	[unit]
		      type=Wave20d
		      x,y=5,3
	              side=5
		[/unit]
                [if]
                     [variable]
                         name=players
			 greater_than=1
                     [/variable]

                     [then]
               	[unit]
		      type=Wave20a
		      x,y=45,3
	              side=5
		[/unit]
               	[unit]
		      type=Wave20b
		      x,y=45,5
	              side=5
		[/unit]

               	[unit]
		      type=Wave20c
		      x,y=43,2
	              side=5
		[/unit]

               	[unit]
		      type=Wave20d
		      x,y=41,3
	              side=5
		[/unit]
                     [/then]
		[/if]

                [if]
                     [variable]
                         name=players
			 greater_than=2
                     [/variable]

                     [then]
               	[unit]
		      type=Wave20a
		      x,y=1,44
	              side=5
		[/unit]
               	[unit]
		      type=Wave20b
		      x,y=1,46
	              side=5
		[/unit]
               	[unit]
		      type=Wave20c
		      x,y=3,47
	              side=5
		[/unit]
               	[unit]
		      type=Wave20d
		      x,y=5,46
	              side=5
		[/unit]
                     [/then]
		[/if]

                [if]
                     [variable]
                         name=players
			 greater_than=3
                     [/variable]

                     [then]
               	[unit]
		      type=Wave20a
		      x,y=45,44
	              side=5
		[/unit]
               	[unit]
		      type=Wave20b
		      x,y=45,46
	              side=5
		[/unit]
               	[unit]
		      type=Wave20c
		      x,y=43,47
	              side=5
		[/unit]
               	[unit]
		      type=Wave20d
		      x,y=41,46
	              side=5
		[/unit]
                     [/then]
		[/if]
	[/event]

	[event]
		name=turn 76
               	[unit]
		      type=Wave24A
		      x,y=1,3
	              side=5
		[/unit]
               	[unit]
		      type=Wave24B
		      x,y=1,5
	              side=5
		[/unit]
               	[unit]
		      type=Wave24C
		      x,y=3,2
	              side=5
		[/unit]
               	[unit]
		      type=Wave24D
		      x,y=5,3
	              side=5
		[/unit]
                [if]
                     [variable]
                         name=players
			 greater_than=1
                     [/variable]

                     [then]
               	[unit]
		      type=Wave24A
		      x,y=45,3
	              side=5
		[/unit]
               	[unit]
		      type=Wave24B
		      x,y=45,5
	              side=5
		[/unit]

               	[unit]
		      type=Wave24C
		      x,y=43,2
	              side=5
		[/unit]

               	[unit]
		      type=Wave24D
		      x,y=41,3
	              side=5
		[/unit]
                     [/then]
		[/if]

                [if]
                     [variable]
                         name=players
			 greater_than=2
                     [/variable]

                     [then]
               	[unit]
		      type=Wave24A
		      x,y=1,44
	              side=5
		[/unit]
               	[unit]
		      type=Wave24B
		      x,y=1,46
	              side=5
		[/unit]
               	[unit]
		      type=Wave24C
		      x,y=3,47
	              side=5
		[/unit]
               	[unit]
		      type=Wave24D
		      x,y=5,46
	              side=5
		[/unit]
                     [/then]
		[/if]

                [if]
                     [variable]
                         name=players
			 greater_than=3
                     [/variable]

                     [then]
               	[unit]
		      type=Wave24A
		      x,y=45,44
	              side=5
		[/unit]
               	[unit]
		      type=Wave24B
		      x,y=45,46
	              side=5
		[/unit]
               	[unit]
		      type=Wave24C
		      x,y=43,47
	              side=5
		[/unit]
               	[unit]
		      type=Wave24D
		      x,y=41,46
	              side=5
		[/unit]
                     [/then]
		[/if]
	[/event]

	[event]
		name=turn 80
               	[unit]
		      type=Wave25a
		      x,y=1,3
	              side=5
		[/unit]
               	[unit]
		      type=Wave25b
		      x,y=1,5
	              side=5
		[/unit]
               	[unit]
		      type=Wave25c
		      x,y=3,2
	              side=5
		[/unit]
               	[unit]
		      type=Wave25d
		      x,y=5,3
	              side=5
		[/unit]
                [if]
                     [variable]
                         name=players
			 greater_than=1
                     [/variable]

                     [then]
               	[unit]
		      type=Wave25a
		      x,y=45,3
	              side=5
		[/unit]
               	[unit]
		      type=Wave25b
		      x,y=45,5
	              side=5
		[/unit]

               	[unit]
		      type=Wave25c
		      x,y=43,2
	              side=5
		[/unit]

               	[unit]
		      type=Wave25d
		      x,y=41,3
	              side=5
		[/unit]
                     [/then]
		[/if]

                [if]
                     [variable]
                         name=players
			 greater_than=2
                     [/variable]

                     [then]
               	[unit]
		      type=Wave25a
		      x,y=1,44
	              side=5
		[/unit]
               	[unit]
		      type=Wave25b
		      x,y=1,46
	              side=5
		[/unit]
               	[unit]
		      type=Wave25c
		      x,y=3,47
	              side=5
		[/unit]
               	[unit]
		      type=Wave25d
		      x,y=5,46
	              side=5
		[/unit]
                     [/then]
		[/if]

                [if]
                     [variable]
                         name=players
			 greater_than=3
                     [/variable]

                     [then]
               	[unit]
		      type=Wave25a
		      x,y=45,44
	              side=5
		[/unit]
               	[unit]
		      type=Wave25b
		      x,y=45,46
	              side=5
		[/unit]
               	[unit]
		      type=Wave25c
		      x,y=43,47
	              side=5
		[/unit]
               	[unit]
		      type=Wave25d
		      x,y=41,46
	              side=5
		[/unit]
                     [/then]
		[/if]
	[/event]

{WAVEST 15 5}
{WAVEST 18 6}
{WAVEST 21 7}
{WAVEST 24 8}
{WAVEST 28 9}
{WAVEST 31 10}
{WAVEST 34 11}
{WAVEST 40 13}
{WAVEST 43 14}
{WAVEST 46 15}
{WAVEST 54 17}
{WAVEST 57 18}
{WAVEST 60 19}
{WAVEST 67 21}
{WAVEST 70 22}
{WAVEST 73 23}


############################################################ Bounty
	[event]
		name=last breath
		first_time_only=no
		[filter]
			side=5
			canrecruit=no
		[/filter]
                       [store_unit]
                           [filter]
                           x,y=$x1,$y1
                           [/filter]
                           variable=recentkill
			   kill=no
                       [/store_unit]
            [if]
                [variable]
                   name=side_number
                   equals=6
                [/variable]
                [then]
                     [gold]
                          side=1
                          amount=$recentkill.cost
                     [/gold]
                [/then]
             [/if]
            [if]
                [variable]
                   name=side_number
                   equals=7
                [/variable]
                [then]
                     [gold]
                          side=2
                          amount=$recentkill.cost
                     [/gold]
                [/then]
             [/if]
            [if]
                [variable]
                   name=side_number
		   equals=8
                [/variable]
                [then]
                     [gold]
                          side=3
                          amount=$recentkill.cost
                     [/gold]
                [/then]
             [/if]
            [if]
                [variable]
                   name=side_number
                   equals=9
                [/variable]
                [then]
                     [gold]
                          side=4
                          amount=$recentkill.cost
                     [/gold]
                [/then]
             [/if]
		[sound]
			name=gold.ogg
		[/sound]
                [unstore_unit]
                     variable=recentkill
                     text="$recentkill.cost"
                     red,green,blue=204,204,51
                [/unstore_unit]
	[/event]
#######################################TowerHurt
        [event]
            name=moveto
            [filter]
                x=23,23,23,22,22,24,24
                y=23,24,25,23,24,24,23
            [/filter]
            first_time_only=no
            [kill]
              x,y=$x1,$y1
              animate=no
            [/kill]
            [set_variable]
                 name=lives
                 add=-1
            [/set_variable]
                    [store_unit]
                           [filter]
                           x,y=23,24
                           [/filter]
                           variable=tower
			   kill=no
                       [/store_unit]
            [set_variable]
                 name=tower.hitpoints
                 add=-1
            [/set_variable]
            [set_variable]
                 name=tower.max_hitpoints
                 add=-1
            [/set_variable]
                    [unstore_unit]
                           [filter]
                           x,y=23,25
                           [/filter]
                           variable=tower
			   kill=no
	                   text="$tower.max_hitpoints"
                           red,green,blue=200,50,50
                    [/unstore_unit]
	{QUAKE (rumble.ogg)}
		[sound]
			name=rumble.ogg
		[/sound]     
		[if]
			[variable]
				name=tower.hitpoints
				equals=0
			[/variable]
				[then]
				      [endlevel]
					    result=defeat
				      [/endlevel]
				[/then]
		[/if]      
        [/event]

####################################################Blaster ranged attack
	[event]
	     name=side turn
             first_time_only=no
	    [store_unit]
        	[filter]
            	type=blaster0
                side=$side_number
        	[/filter]
       	        variable=blaster
        	kill=no
    	    [/store_unit]
 	    {FOREACH blaster b}
            [if]
            [have_unit]
                 side=5
                 [filter_location]
                       x,y=$blaster[$b].x,$blaster[$b].y
                       radius=3
                 [/filter_location]
                 [not]
                    id=target
                 [/not]
            [/have_unit]
            [then]
                [scroll_to_unit]
                      x,y=$blastter[$b].x,$blaster[$b].y
                [/scroll_to_unit]
		[delay]
                    time=100
                [/delay]
                [animate_unit]
                       [filter]
                            id=witch
                       [/filter]
                       flag=lightbeam
                       with_bars=yes
                [/animate_unit]
                [sound]
                    name=magic-holy-1.ogg
                [/sound]
                [delay]
                    time=100
                [/delay]
               [store_unit]
                   [filter]
                        side=5
                        [filter_location]
                             x,y=$blaster[$b].x,$blaster[$b].y
                             radius=3
                        [/filter_location]
                        [not]
                             id=target
                        [/not]
                   [/filter]
                   variable=target
                   kill=no
               [/store_unit]
               {VARIABLE damage 30}
               {VARIABLE_OP damage multiply $target.resistance.arcane}
               {VARIABLE_OP damage divide 100}
               {VARIABLE_OP target.hitpoints add -$damage}
            [unstore_unit]
                variable=target
                text="$damage"
                red,green,blue=250,250,250
            [/unstore_unit]

         [if]
         [variable]
            name=target.hitpoints
            less_than=1
         [/variable]
         [then]
            [fire_event]
               name=die
               [primary_unit]
                  x,y=$target.x,$target.y
               [/primary_unit]
               [secondary_unit]
                  x,y=$blaster[$b].x,$blaster[$b].y
               [/secondary_unit]
            [/fire_event]
            [kill]
               id=$target.id
               animate=yes
               fire_event=yes
            [/kill]
            [/then]
          [/if]

            [/then]
            [/if]
            {NEXT b}
	[/event]

	[event]
	     name=side turn
             first_time_only=no
	    [store_unit]
        	[filter]
            	type=blaster1
                side=$side_number
        	[/filter]
       	        variable=blaster
        	kill=no
    	    [/store_unit]
 	    {FOREACH blaster b}
            [if]
            [have_unit]
                 side=5
                 [filter_location]
                       x,y=$blaster[$b].x,$blaster[$b].y
                       radius=3
                 [/filter_location]
                 [not]
                    id=target
                 [/not]
            [/have_unit]
            [then]
                [scroll_to_unit]
                      x,y=$blastter[$b].x,$blaster[$b].y
                [/scroll_to_unit]
		[delay]
                    time=100
                [/delay]
                [animate_unit]
                       [filter]
                            id=witch
                       [/filter]
                       flag=lightbeam
                       with_bars=yes
                [/animate_unit]
                [sound]
                    name=magic-holy-1.ogg
                [/sound]
                [delay]
                    time=100
                [/delay]
               [store_unit]
                   [filter]
                        side=5
                        [filter_location]
                             x,y=$blaster[$b].x,$blaster[$b].y
                             radius=3
                        [/filter_location]
                         [not]
                              id=target
                         [/not]
                   [/filter]
                   variable=target
                   kill=no
               [/store_unit]
               {VARIABLE damage 45}
               {VARIABLE_OP damage multiply $target.resistance.arcane}
               {VARIABLE_OP damage divide 100}
               {VARIABLE_OP target.hitpoints add -$damage}
            [unstore_unit]
                variable=target
                text="$damage"
                red,green,blue=250,250,250
            [/unstore_unit]

         [if]
         [variable]
            name=target.hitpoints
            less_than=1
         [/variable]
         [then]
            [fire_event]
               name=die
               [primary_unit]
                  x,y=$target.x,$target.y
               [/primary_unit]
               [secondary_unit]
                  x,y=$blaster[$b].x,$blaster[$b].y
               [/secondary_unit]
            [/fire_event]
            [kill]
               id=$target.id
               animate=yes
               fire_event=yes
            [/kill]
            [/then]
          [/if]

            [/then]
            [/if]
            {NEXT b}
	[/event]

	[event]
	     name=side turn
             first_time_only=no
	    [store_unit]
        	[filter]
            	type=blaster2
                side=$side_number
        	[/filter]
       	        variable=blaster
        	kill=no
    	    [/store_unit]
 	    {FOREACH blaster b}
            [if]
            [have_unit]
                 side=5
                 [filter_location]
                       x,y=$blaster[$b].x,$blaster[$b].y
                       radius=3
                 [/filter_location]
                 [not]
                    id=target
                 [/not]
            [/have_unit]
            [then]
                [scroll_to_unit]
                      x,y=$blastter[$b].x,$blaster[$b].y
                [/scroll_to_unit]
		[delay]
                    time=100
                [/delay]
                [animate_unit]
                       [filter]
                            id=witch
                       [/filter]
                       flag=lightbeam
                       with_bars=yes
                [/animate_unit]
                [sound]
                    name=magic-holy-1.ogg
                [/sound]
                [delay]
                    time=100
                [/delay]
               [store_unit]
                   [filter]
                        side=5
                        [filter_location]
                             x,y=$blaster[$b].x,$blaster[$b].y
                             radius=3
                        [/filter_location]
                        [not]
                           id=target
                        [/not]
                   [/filter]
                   variable=target
                   kill=no
               [/store_unit]
               {VARIABLE damage 60}
               {VARIABLE_OP damage multiply $target.resistance.arcane}
               {VARIABLE_OP damage divide 100}
               {VARIABLE_OP target.hitpoints add -$damage}
            [unstore_unit]
                variable=target
                text="$damage"
                red,green,blue=250,250,250
            [/unstore_unit]

         [if]
         [variable]
            name=target.hitpoints
            less_than=1
         [/variable]
         [then]
            [fire_event]
               name=die
               [primary_unit]
                  x,y=$target.x,$target.y
               [/primary_unit]
               [secondary_unit]
                  x,y=$blaster[$b].x,$blaster[$b].y
               [/secondary_unit]
            [/fire_event]
            [kill]
               id=$target.id
               animate=yes
               fire_event=yes
            [/kill]
            [/then]
          [/if]

            [/then]
            [/if]
            {NEXT b}
	[/event]

[/multiplayer]
